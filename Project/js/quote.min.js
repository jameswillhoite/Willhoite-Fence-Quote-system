var Customer=(function(){function a(){this.fullName=null;this.address=null;this.city=null;this.taxCity=null;this.state=null;this.zip=null;this.phone=null;this.phoneType=null;this.email=null;this.id=null;this.addressID=null;this.dateSold=null}a.prototype={constructor:a,setID:function(b){this.id=parseInt(b)},getID:function(){return this.id},setAddressID:function(b){this.addressID=parseInt(b)},getAddressID:function(){return this.addressID},setDateSold:function(b){this.dateSold=String(b)},getDateSold:function(){return this.dateSold},setName:function(b){this.fullName=b},getName:function(){return this.fullName},setAddress:function(b){this.address=b},getAddress:function(){return this.address},setCity:function(b){this.city=b},getCity:function(){return this.city},setTaxCity:function(b){this.taxCity=b},getTaxCity:function(){return this.taxCity},setState:function(b){this.state=b},getState:function(){return this.state},setZip:function(b){this.zip=b},getZip:function(){return this.zip},setPhone:function(c,b){this.phone=b;this.phoneType=c},getPhone:function(){return{phone:this.phone,type:this.phoneType}},addEmail:function(b){this.email=b},getEmail:function(){return this.email}};return a}());var MyReg=(function(){var a;function b(c){this[a]=c}b.prototype={constructor:b,setTestStr:function(c){this[a]=c},alpha:function(d){if(d){this.setTestStr(d)}if(!this[a]){return false}var c=new RegExp(/^[a-zA-Z\s]+$/);return c.test(this[a])},alphaNumeric:function(d){if(d){this.setTestStr(d)}if(!this[a]){return false}var c=new RegExp(/^[a-zA-Z0-9\s]+$/);return c.test(this[a])},numeric:function(d){if(d){this.setTestStr(d)}if(!this[a]){return false}var c=new RegExp(/^[0-9]+$/);return c.test(this[a])},doble:function(d){if(d){this.setTestStr(d)}if(!this[a]){return false}var c=new RegExp(/^[0-9]+\.?[0-9]{0,2}$/);return c.test(this[a])},address:function(d){if(d){this.setTestStr(d)}if(!this[a]){return false}var c=new RegExp(/^[0-9]+\s?[a-zA-Z\s\.]{3,}$/);return c.test(this[a])},state:function(d){if(d){this.setTestStr(d)}if(!this[a]){return false}var c=new RegExp(/^[a-zA-Z]{2,2}$/);return c.test(this[a])},zip:function(d){if(d){this.setTestStr(d)}if(!this[a]){return false}var c=new RegExp(/^[0-9]{5,5}$|^[0-9]{5,5}\-[0-9]{4,4}$/);return c.test(this[a])},date:function(d){if(d){this.setTestStr(d)}if(!this[a]){return false}var c=new RegExp(/^[0-9]{1,2}[\-\/]{1,1}[0-9]{1,2}[\-\/]{1,1}(?:[0-9]{2,2}|[0-9]{4,4})$/);return c.test(this[a])},phone:function(d){if(d){this.setTestStr(d)}if(!this[a]){return false}var c=new RegExp(/^[0-9\(\)\-\s]+$/);return c.test(this[a])},email:function(d){if(d){this.setTestStr(d)}if(!this[a]){return false}var c=new RegExp(/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/);return c.test(this[a])}};return b}());var Draw=(function(){var b;function p(){var u=document.getElementById("fenceDrawingDiv");b=document.createElement("canvas");b.setAttribute("id","fenceDrawing");b.setAttribute("class","form-control");u.appendChild(b);var x=jQuery("canvas#fenceDrawing");var v=x.outerWidth();var y=x.outerHeight();x.attr("width",v);x.attr("height",y);if(typeof G_vmlCanvasManager!="undefined"){b=G_vmlCanvasManager.initElement(b)}a=b.getContext("2d");x.mousedown(function(z){o(z);h=true;i(f,e);q()});x.mousemove(function(z){o(z);if(h){i(f,e,true);q()}});x.mouseup(function(z){h=false});x.mouseleave(function(z){h=false});var w=jQuery("div#canvasTools");w.find("select#size").on("change",function(){k=jQuery(this).val()});var t=false;w.find("button#erase").on("click",function(){if(!t){r=s;s="#ffffff";t=true;jQuery(this).addClass("active")}else{s=r;t=false;jQuery(this).removeClass("active")}});g()}var a;var l=[];var j=[];var d=[];var n=[];var s="#000000";var r=null;var c=[];var k=1;var f,e;var h=false;function i(t,v,u){l.push(t);j.push(v);d.push(u);c.push(k);n.push(s)}function q(){a.clearRect(0,0,a.canvas.width,a.canvas.height);a.lineJoin="round";g();for(var t=0;t<l.length;t++){a.beginPath();if(d[t]&&t){a.moveTo(l[t-1],j[t-1])}else{a.moveTo(l[t]-1,j[t])}a.lineTo(l[t],j[t]);a.closePath();a.strokeStyle=n[t];a.lineWidth=c[t];a.stroke()}}function o(t){if(!t){var t=event}if(t.offsetX){f=t.offsetX;e=t.offsetY}else{if(t.layerX){f=t.layerX;e=t.layerY}}m(f,e)}function m(t,u){jQuery("div#showXY").html(t+","+u)}function g(){a.strokeRect(173,169,185,60);a.font="24px Arial";a.strokeText("HOUSE",225,208)}p.prototype={constructor:p};return p}());function MasterStyleList(){var b=[];function a(c,e,d,f){this.styleID=parseInt(c);this.description=String(e);this.type=String(d);this.postSpacing=parseFloat(f);this.heightPrice=[];this.gates=[]}a.prototype={addHeightPrice:function(f,c,e){var d={heightID:parseInt(f),height:c,pricePerFoot:parseFloat(e)};this.heightPrice.push(d)},addGateAndPrice:function(d,g,e,f){var c={gateID:parseInt(d),heightID:parseInt(g),width:e,price:parseFloat(f)};this.gates.push(c)},getHeightByID:function(d){for(var c=0;c<this.heightPrice.length;c++){if(this.heightPrice[c].heightID===parseInt(d)){return this.heightPrice[c]}}return null},getAllHeights:function(){var d=[];for(var c=0;c<this.heightPrice.length;c++){d.push({id:this.heightPrice[c].heightID,height:this.heightPrice[c].height})}return d}};this.addMasterStyle=function(c,f,e,g){var d=new a(c,f,e,g);b.push(d);return d};this.getStyleByID=function(d){for(var c=0;c<b.length;c++){if(b[c].styleID===parseInt(d)){return b[c]}}return null};this.getStyleArray=function(){var d=[];for(var c=0;c<b.length;c++){d.push({id:b[c].styleID,desc:b[c].description})}return d};this.getGateByWidthHeight=function(f,h,i){for(var e=0;e<b.length;e++){var d=b[e];if(d.styleID===parseInt(f)){for(var c=0;c<d.gates.length;c++){var g=d.gates[c];if(g.width===h&&g.heightID===parseInt(i)){return g}}}}return null}}function Styles(){var b=[];function a(c){this.id=parseInt(c);this.databaseID=null;this.type=null;this.styleID=null;this.styleDescription=null;this.measurements={frontRight:0,right:0,back:0,left:0,frontLeft:0,extra1:0,extra2:0,extra3:0};this.totalFeetOfFence=0;this.pricePerFoot=0;this.heightID=null;this.height=0;this.postTopID=null;this.postTopDescription=null;this.postSpacing=0;this.subTotal=0;this.el={style:{subtotal:null,totalFeet:null,pricePerFoot:null,pricePerFootAmount:null,gate4FootPrice:null,gate4FootAmount:null,gate5FootPrice:null,gate5FootAmount:null,gate8FootPrice:null,gate8FootAmount:null,gate10FootPrice:null,gate10FootAmount:null,endPostsPrice:null,endPostsAmount:null,cornerPostsPrice:null,cornerPostsAmount:null,gatePostsPrice:null,gatePostsAmount:null,postTopsQty:null,postTopsPrice:null,postTopsAmount:null,temporaryFenceAmount:null,temporaryFencePrice:null,removalOldFencePrice:null,removalOldFenceAmount:null,permitPrice:null,permitAmount:null,removableSectionPrice:null,removableSectionAmount:null,haulAwayDirtPrice:null,haulAwayDirtAmount:null,upgradedLatchPrice:null,upgradedLatchAmount:null,upgradedHingePrice:null,upgradedHingeAmount:null}};this.gate4FootPrice=0;this.gate4FootQty=0;this.gate5FootPrice=0;this.gate5FootQty=0;this.gate8FootPrice=0;this.gate8FootQty=0;this.gate10FootPrice=0;this.gate10FootQty=0;this.endPostsPrice=0;this.endPostsQty=0;this.cornerPostsPrice=0;this.cornerPostsQty=0;this.gatePostsPrice=0;this.gatePostsQty=0;this.postTopsPrice=0;this.postTopsQty=0;this.temporaryFencePrice=0;this.temporaryFenceQty=0;this.removalOldFencePrice=0;this.removalOldFenceQty=0;this.permitPrice=0;this.permitQty=0;this.removableSectionPrice=0;this.removableSectionQty=0;this.haulAwayDirtPrice=0;this.haulAwayDirtQty=0;this.upgradedLatchPrice=0;this.upgradedLatchQty=0;this.upgradedHingePrice=0;this.upgradedHingeQty=0}a.prototype={setDatabaseID:function(c){this.databaseID=parseInt(c)},setStyleOfFence:function(d,c,e,f){this.styleID=parseInt(d);this.styleDescription=String(c);this.type=String(e).toLowerCase();this.postSpacing=parseFloat(f);this.setPricePerFoot(0);this.updatePricePerFootAmount()},setHeight:function(d,c){this.heightID=parseInt(d);this.height=parseInt(c)},setPostTop:function(c){this.postTopID=parseInt(c);this.updatePostTopsAmount()},setPricePerFoot:function(c){this.pricePerFoot=parseFloat(c);this.el.style.pricePerFoot.html(parseFloat(this.pricePerFoot).toFixed(2));this.updatePricePerFootAmount()},updatePricePerFootAmount:function(){this.el.style.pricePerFootAmount.html(parseFloat(this.totalFeetOfFence*this.pricePerFoot).toFixed(2));this.updateSubTotal()},setMeasurement:function(c,d){switch(c){case"frontRight":this.measurements.frontRight=parseInt(d);break;case"right":this.measurements.right=parseInt(d);break;case"back":this.measurements.back=parseInt(d);break;case"left":this.measurements.left=parseInt(d);break;case"frontLeft":this.measurements.frontLeft=parseInt(d);break;case"extra1":this.measurements.extra1=parseInt(d);break;case"extra2":this.measurements.extra2=parseInt(d);break;case"extra3":this.measurements.extra3=parseInt(d);break}this.totalFeetOfFence=this.measurements.frontRight+this.measurements.right+this.measurements.back+this.measurements.left+this.measurements.frontLeft+this.measurements.extra1+this.measurements.extra2+this.measurements.extra3;this.el.style.totalFeet.html(this.totalFeetOfFence);this.updatePricePerFootAmount()},setGate4FootQty:function(c){this.gate4FootQty=parseInt(c);this.updateGate4FootAmount()},setGate4FootPrice:function(c){this.gate4FootPrice=parseFloat(c);this.el.style.gate4FootPrice.html(this.gate4FootPrice.toFixed(2));this.updateGate4FootAmount()},updateGate4FootAmount:function(){this.el.style.gate4FootAmount.html(parseFloat(this.gate4FootQty*this.gate4FootPrice).toFixed(2));this.updateSubTotal()},setGate5FootQty:function(c){this.gate5FootQty=parseInt(c);this.updateGate5FootAmount()},setGate5FootPrice:function(c){this.gate5FootPrice=parseFloat(c);this.el.style.gate5FootPrice.html(this.gate5FootPrice.toFixed(2));this.updateGate5FootAmount()},updateGate5FootAmount:function(){this.el.style.gate5FootAmount.html((this.gate5FootQty*this.gate5FootPrice).toFixed(2));this.updateSubTotal()},setGate8FootQty:function(c){this.gate8FootQty=parseInt(c);this.updateGate8FootAmount()},setGate8FootPrice:function(c){this.gate8FootPrice=parseFloat(c);this.el.style.gate8FootPrice.html(this.gate8FootPrice.toFixed(2));this.updateGate8FootAmount()},updateGate8FootAmount:function(){this.el.style.gate8FootAmount.html((this.gate8FootQty*this.gate8FootPrice).toFixed(2));this.updateSubTotal()},setGate10FootQty:function(c){this.gate10FootQty=parseInt(c);this.updateGate8FootAmount()},setGate10FootPrice:function(c){this.gate10FootPrice=parseFloat(c);this.el.style.gate10FootPrice.html(this.gate10FootPrice.toFixed(2));this.updateGate10FootAmount()},updateGate10FootAmount:function(){this.el.style.gate10FootAmount.html((this.gate10FootQty*this.gate10FootPrice).toFixed(2));this.updateSubTotal()},setEndPostsQty:function(c){this.endPostsQty=parseInt(c);this.updateEndPostsAmount()},setEndPostsPrice:function(c){this.endPostsPrice=parseFloat(c);this.el.style.endPostsPrice.html(this.endPostsPrice.toFixed(2));this.updateEndPostsAmount()},updateEndPostsAmount:function(){this.el.style.endPostsAmount.html((this.endPostsQty*this.endPostsPrice).toFixed(2));this.updateSubTotal()},setCornerPostsQty:function(c){this.cornerPostsQty=parseInt(c);this.updateCornerPostsAmount()},setCornerPostsPrice:function(c){this.cornerPostsPrice=parseFloat(c);this.el.style.cornerPostsPrice.html(this.cornerPostsPrice.toFixed(2));this.updateCornerPostsAmount()},updateCornerPostsAmount:function(){this.el.style.cornerPostsAmount.html((this.cornerPostsQty*this.cornerPostsPrice).toFixed(2));this.updateSubTotal()},setGatePostsQty:function(c){this.gatePostsQty=parseInt(c);this.updateGatePostsAmount()},setGatePostsPrice:function(c){this.gatePostsPrice=parseFloat(c);this.el.style.gatePostsPrice.html(this.gatePostsPrice.toFixed(2));this.updateGatePostsAmount()},updateGatePostsAmount:function(){this.el.style.gatePostsAmount.html((this.gatePostsQty*this.gatePostsPrice).toFixed(2));this.updateSubTotal()},setPostTopsQty:function(c){this.postTopsQty=parseInt(c);this.updatePostTopsAmount()},setPostTopsPrice:function(c){this.postTopsPrice=parseFloat(c);this.el.style.postTopsPrice.html(this.postTopsPrice.toFixed(2));this.updatePostTopsAmount()},updatePostTopsAmount:function(){this.el.style.postTopsAmount.html((this.postTopsQty*this.postTopsPrice).toFixed(2));this.updateSubTotal()},updatePostTopsQty:function(){this.postTopsQty=Math.ceil(this.totalFeetOfFence/this.postSpacing)+3;this.el.style.postTopsQty.html(this.postTopsQty);this.updatePostTopsAmount();this.updateSubTotal()},setTemporaryFenceQty:function(c){this.temporaryFenceQty=parseInt(c);this.updateTemporaryFenceAmount()},setTemporaryFencePrice:function(c){this.temporaryFencePrice=parseFloat(c);this.el.style.temporaryFencePrice.html(this.temporaryFencePrice.toFixed(2));this.updateTemporaryFenceAmount()},updateTemporaryFenceAmount:function(){this.el.style.temporaryFenceAmount.html((this.temporaryFenceQty*this.temporaryFencePrice).toFixed(2));this.updateSubTotal()},setRemovalOldFenceQty:function(c){this.removalOldFenceQty=parseInt(c);this.updateRemovalOldFenceAmount()},setRemovalOldFencePrice:function(c){this.removalOldFencePrice=parseFloat(c);this.el.style.removalOldFencePrice.html(this.removalOldFencePrice.toFixed(2));this.updateRemovalOldFenceAmount()},updateRemovalOldFenceAmount:function(){this.el.style.removalOldFenceAmount.html((this.removalOldFenceQty*this.removalOldFencePrice).toFixed(2));this.updateSubTotal()},setPermitQty:function(c){this.permitQty=parseInt(c);this.updatePermitAmount()},setPermitPrice:function(c){this.permitPrice=parseFloat(c);this.el.style.permitPrice.html(this.permitPrice.toFixed(2));this.updatePermitAmount()},updatePermitAmount:function(){this.el.style.permitAmount.html((this.permitQty*this.permitPrice).toFixed(2));this.updateSubTotal()},setRemovableSectionQty:function(c){this.removableSectionQty=parseInt(c);this.updateRemovableSectionAmount()},setRemovableSectionPrice:function(c){this.removableSectionPrice=parseFloat(c);this.el.style.removableSectionPrice.html(this.removableSectionPrice.toFixed(2));this.updateRemovableSectionAmount()},updateRemovableSectionAmount:function(){this.el.style.removableSectionAmount.html((this.removableSectionQty*this.removableSectionPrice).toFixed(2));this.updateSubTotal()},setHaulAwayDirtQty:function(c){this.haulAwayDirtQty=parseInt(c);this.updateHaulAwayDirtAmount()},setHaulAwayDirtPrice:function(c){this.haulAwayDirtPrice=parseFloat(c);this.el.style.haulAwayDirtPrice.html(this.haulAwayDirtPrice.toFixed(2));this.updateHaulAwayDirtAmount()},updateHaulAwayDirtAmount:function(){this.el.style.haulAwayDirtAmount.html((this.haulAwayDirtQty*this.haulAwayDirtPrice).toFixed(2));this.updateSubTotal()},setUpgradedLatchQty:function(c){this.upgradedLatchQty=parseInt(c);this.updateUpgradedLatchAmount()},setUpgradedLatchPrice:function(c){this.upgradedLatchPrice=parseFloat(c);this.el.style.upgradedLatchPrice.html(this.upgradedLatchPrice.toFixed(2));this.updateUpgradedLatchAmount()},updateUpgradedLatchAmount:function(){this.el.style.upgradedLatchAmount.html((this.upgradedLatchQty*this.upgradedLatchPrice).toFixed(2));this.updateSubTotal()},setUpgradedHingeQty:function(c){this.upgradedHingeQty=parseInt(c);this.updateUpgradedHingeAmount()},setUpgradedHingePrice:function(c){this.upgradedHingePrice=parseFloat(c);this.el.style.upgradedHingePrice.html(this.upgradedHingePrice.toFixed(2));this.updateUpgradedHingeAmount()},updateUpgradedHingeAmount:function(){this.el.style.upgradedHingeAmount.html((this.upgradedHingeQty*this.upgradedHingePrice).toFixed(2));this.updateSubTotal()},getTotalFeetFence:function(){return this.totalFeetOfFence},getPricePerFoot:function(){return this.pricePerFoot},getStyleFence:function(){return this.styleDescription},getStyleFenceID:function(){return this.styleID},updateSubTotal:function(){this.subTotal=0;this.subTotal+=(this.totalFeetOfFence*this.pricePerFoot);this.subTotal+=(this.gate4FootQty*this.gate4FootPrice);this.subTotal+=(this.gate5FootQty*this.gate5FootPrice);this.subTotal+=(this.gate8FootQty*this.gate8FootPrice);this.subTotal+=(this.gate10FootQty*this.gate10FootPrice);this.subTotal+=(this.endPostsQty*this.endPostsPrice);this.subTotal+=(this.cornerPostsQty*this.cornerPostsPrice);this.subTotal+=(this.gatePostsQty*this.gatePostsPrice);this.subTotal+=(this.postTopsQty*this.postTopsPrice);this.subTotal+=(this.temporaryFenceQty*this.temporaryFencePrice);this.subTotal+=(this.removalOldFenceQty*this.removalOldFencePrice);this.subTotal+=(this.permitQty*this.permitPrice);this.subTotal+=(this.removableSectionQty*this.removableSectionPrice);this.subTotal+=(this.haulAwayDirtQty*this.haulAwayDirtPrice);this.subTotal+=(this.upgradedLatchQty*this.upgradedLatchPrice);this.subTotal+=(this.upgradedHingeQty*this.upgradedHingePrice);this.el.style.subtotal.html(this.subTotal.toFixed(2))},getSubtotal:function(){return this.subTotal},getJsonArray:function(){return{DatabaseID:this.databaseID,ID:this.id,StyleID:this.styleID,HeightID:this.heightID,PostTopID:this.postTopID,Measurements:{FrontLeft:this.measurements.frontLeft,Left:this.measurements.left,Back:this.measurements.back,Right:this.measurements.right,FrontRight:this.measurements.frontRight,Extra1:this.measurements.extra1,Extra2:this.measurements.extra2,Extra3:this.measurements.extra3},TotalFeetFence:this.totalFeetOfFence,PricePerFoot:this.pricePerFoot,Gate4Qty:this.gate4FootQty,Gate4Price:this.gate4FootPrice,Gate5Qty:this.gate5FootQty,Gate5Price:this.gate5FootPrice,Gate8Qty:this.gate8FootQty,Gate8Price:this.gate8FootPrice,Gate10Qty:this.gate10FootQty,Gate10Price:this.gate10FootPrice,EndPostQty:this.endPostsQty,EndPostPrice:this.endPostsPrice,CornerPostQty:this.cornerPostsQty,CornerPostPrice:this.cornerPostsPrice,GatePostQty:this.gatePostsQty,GatePostPrice:this.gatePostsPrice,PostTopQty:this.postTopsQty,PostTopPrice:this.postTopsPrice,TempFenceQty:this.temporaryFenceQty,TempFencePrice:this.temporaryFencePrice,RemoveFenceQty:this.removalOldFenceQty,RemoveFencePrice:this.removalOldFencePrice,PermitQty:this.permitQty,PermitPrice:this.permitPrice,RemoveSectionQty:this.removableSectionQty,RemoveSectionPrice:this.removableSectionPrice,HaulDirtQty:this.haulAwayDirtQty,HaulDirtPrice:this.haulAwayDirtPrice,UpgradedLatchQty:this.upgradedLatchQty,UpgradedLatchPrice:this.upgradedLatchPrice,UpgradedHingeQty:this.upgradedHingeQty,UpgradedHingePrice:this.upgradedHingePrice}}};this.addStyle=function(d){var c=new a(d);b.push(c);return c};this.removeStyle=function(e){var d=null;for(var c=0;c<b.length;c++){if(b[c].id===parseInt(e)){d=b.splice(c,1);break}}return d};this.getStyle=function(e){var d=null;for(var c=0;c<b.length;c++){if(b[c].id===parseInt(e)){d=b[c];break}}return d};this.getAllStyles=function(){return b}}"use strict";var quote={Customer:new Customer(),MasterStyleList:new MasterStyleList(),numOfStyles:0,Styles:new Styles(),postTops:[],miscPrices:[],jobID:null,Draw:null,init:function(){var b=this;jQuery("input#contractDate").datepicker({format:"mm/dd/yyyy",autoclose:true,assumeNearbyYear:true,disableTouchKeyboard:true,todayHighlight:true});b.addStyleMeasurement();b.setCustomerListeners();b.emailQuoteListeners();var d=jQuery("div#main-content div#customerInfo");d.find("input#contractDate").on("click",function(){jQuery(this).attr("disabled",false)});var c=jQuery('a[data-toggle="tab"]');c.on("shown.bs.tab",function(f){if(f.target.id==="drawing-Tab"&&!b.Draw){b.Draw=new Draw()}});c.on("show.bs.tab",function(j){var i=j.target;var g=j.relatedTarget;if(g.id==="customerInfo-Tab"){var f=jQuery("div#main-content div#customerInfo input#customerName");var k=jQuery("div#main-content div#customerInfo input#address");var h=jQuery("div#main-content div#customerInfo input#contractDate");if(!b.Customer.getID()){j.preventDefault();b.displayErrorMsg("Please Select a Customer","danger");b.showCustomer();f.val("").addClass("is-invalid");return}else{f.removeClass("is-invalid")}if(!b.Customer.getAddressID()){j.preventDefault();b.displayErrorMsg("Please Select an Address","danger");b.showAddress();k.val("").addClass("is-invalid");return}else{k.removeClass("is-invalid")}if(!b.Customer.getDateSold()){j.preventDefault();b.displayErrorMsg("Please select a Date Sold","danger");h.addClass("is-invalid");return}else{h.removeClass("is-invalid")}b.saveCustomer()}else{if(g.id==="measurements-Tab"||g.id==="styles-Tab"){b.saveMeasurements()}}});var a=jQuery("div#main-content div#pictures");a.find("input#uploadPicture").on("change",function(f){b.uploadPicture(f.target)});jQuery(document).on("scroll",function(){var e=jQuery("button#scrollToTop");if(document.body.scrollTop>20||document.documentElement.scrollTop>20){e.css("display","block")}else{e.css("display","none")}});jQuery("button#scrollToTop").on("click",function(){jQuery("html, body").animate({scrollTop:"0"},"slow")})},errorID:null,displayErrorMsg:function(a,f,e){var b=this;if(this.errorID){this.errorEl.slideUp("500");clearTimeout(b.errorID);this.errorID=null;this.errorEl=null}var c;var d;if(jQuery("div.modal.show").length>0){c=jQuery("div.modal.show div#error_msg")}else{c=jQuery("div#main-content div#mainErrorMsg div#error_msg")}c.removeClass("alert-success alert-danger alert-info alert-warning");c.empty();c.html(a);c.addClass("alert-"+f);b.errorEl=c;if(e){d=e*1000}else{d=400*a.length}c.slideDown(500);b.errorID=setTimeout(function(){c.slideUp(500)},d)},setCustomerListeners:function(){var a=this;var d=jQuery("div#customerInfo");d.find("input#contractDate").on("change",function(){var f=jQuery(this).val();var e=new MyReg(f);if(!e.date()){jQuery(this).addClass("is-invalid")}else{jQuery(this).removeClass("is-invalid");a.Customer.setDateSold(f)}});var b=jQuery("div#main-content div#addCustomerModal");jQuery("div#main-content input#customerName").on("keyup",function(g){if(g.keyCode===27){return}else{if(g.keyCode===13){return}else{if(g.keyCode>=37&&g.keyCode<=40){return}}}var f=jQuery(this).val();if(f.length>4){a.getCustomerList(f)}});b.on("shown.bs.modal",function(){jQuery(this).find("input#fullName").focus()});jQuery("div#main-content div#customerInfo i#chooseCustomer").on("click",function(){a.showCustomer()});b.find("input#fullName").on("keyup",function(h){var i=jQuery(this).val();var g=jQuery(this);var f=new MyReg();if(!f.alpha(i)){g.addClass("is-invalid")}else{g.removeClass("is-invalid")}});b.find("input#phone").on("keyup",function(h){var i=jQuery(this).val();var g=jQuery(this);var f=new MyReg();if(!f.phone(i)){g.addClass("is-invalid")}else{g.removeClass("is-invalid")}});b.find("input#email").on("keyup",function(h){var i=jQuery(this).val();var g=jQuery(this);var f=new MyReg();if(!f.email(i)){g.addClass("is-invalid")}else{g.removeClass("is-invalid")}});b.find("button#save").on("click",function(k){var i=b.find("input#fullName");var j=b.find("select#phoneType");var g=b.find("input#phone");var h=b.find("input#email");var f=new MyReg();var l=true;if(!f.alpha(i.val())){i.addClass("is-invalid");l=false}else{i.removeClass("is-invalid")}if(!f.phone(g.val())){g.addClass("is-invalid");l=false}else{g.removeClass("is-invalid")}if(h.val().length>0&&!f.email(h.val())){h.addClass("is-invalid");l=false}else{h.removeClass("is-invalid")}if(l){a.addCustomer(i.val(),j.val(),g.val(),h.val())}else{a.displayErrorMsg("Please correct the highlighted fields below","danger")}});b.on("hidden.bs.modal",function(){b.find("input#fullName").val("");b.find("input#phone").val("");b.find("select#phoneType").val("cell");b.find("input#email").val("")});jQuery("div#main-content div#customerInfo input#address").on("keyup",function(g){if(g.keyCode===27){return}else{if(g.keyCode===13){return}else{if(g.keyCode>=37&&g.keyCode<=40){return}}}var f=jQuery(this).val();if(f.length>4){a.getAddressList(f)}});jQuery("div#main-content div#customerInfo i#chooseAddress").on("click",function(){a.showAddress()});var c=jQuery("div#main-content div#addCustomerAddressModal");c.on("shown.bs.modal",function(){jQuery(this).find("input").each(function(){jQuery(this).val("")});jQuery(this).find("input#address").focus()});c.find("input#address").on("keyup",function(){var f=jQuery(this).val();var e=new MyReg();if(!e.address(f)){jQuery(this).addClass("is-invalid")}else{jQuery(this).removeClass("is-invalid")}});c.find("input#city").on("keyup",function(){var f=jQuery(this).val();var e=new MyReg();if(!e.alpha(f)){jQuery(this).addClass("is-invalid")}else{jQuery(this).removeClass("is-invalid")}});c.find("input#state").on("keyup",function(){var f=jQuery(this).val();var e=new MyReg();if(!e.state(f)){jQuery(this).addClass("is-invalid")}else{jQuery(this).removeClass("is-invalid")}});c.find("input#zip").on("keyup",function(){var f=jQuery(this).val();var e=new MyReg();if(!e.zip(f)){jQuery(this).addClass("is-invalid")}else{jQuery(this).removeClass("is-invalid")}});c.find("button#addAddress").on("click",function(){var f=c.find("input#address");var i=c.find("input#city");var h=c.find("input#state");var g=c.find("input#zip");var e=new MyReg();var j=true;if(!e.address(f.val())){f.addClass("is-invalid");j=false}else{f.removeClass("is-invalid")}if(!e.alpha(i.val())){i.addClass("is-invalid");j=false}else{i.removeClass("is-invalid")}if(!e.state(h.val())){h.addClass("is-invalid");j=false}else{h.removeClass("is-invalid")}if(!e.zip(g.val())){g.addClass("is-invalid");j=false}else{g.removeClass("is-invalid")}if(!j){a.displayErrorMsg("Please correct the fields highlighted in red.","danger");return}else{a.addAddress(f.val(),i.val(),h.val(),g.val())}})},addStyleMeasurement:function(){var j=this;j.numOfStyles++;var g=j.Styles.addStyle(j.numOfStyles);var b=jQuery("div#measurements div#stylesDiv");var e=jQuery("div#styles div#stylesDiv");var d='<div class="col-lg-3 col-md-4 col-sm-6 col-xs-12" data-id="'+g.id+'"><fieldset><legend>Style '+g.id+'</legend><div class="row"><div class="col-12"><label for="frontRight">Front Right</label><input type="number" id="frontRight" pattern="\\d*" class="form-control" autocomplete="off" /> </div><div class="col-12"><label for="right">Right Side</label><input type="number" id="right" pattern="\\d*" class="form-control" autocomplete="off" /> </div><div class="col-12"><label for="back">Back</label><input type="number" id="back" pattern="\\d*" class="form-control" /> </div><div class="col-12"><label for="left">Left Side</label><input type="number" id="left" pattern="\\d*" class="form-control" autocomplete="off" /> </div><div class="col-12"><label for="frontLeft">Front Left</label><input type="number" id="frontLeft" pattern="\\d*" class="form-control" autocomplete="off" /> </div><div class="col-12"><label for="extra1">Extra 1</label><input type="number" id="extra1" pattern="\\d*" class="form-control" autocomplete="off" /> </div><div class="col-12"><label for="extra2">Extra 2</label><input type="number" id="extra2" pattern="\\d*" class="form-control" autocomplete="off" /> </div><div class="col-12"><label for="extra3">Extra 3</label><input type="number" id="extra3" pattern="\\d*" class="form-control" autocomplete="off" /> </div></div> <div class="row" style="margin-top:1em;"> <div id="totalFeet" class="col-12">Total: '+g.getTotalFeetFence()+"</div></div></fieldset></div>";b.append(d);var c=b.find('[data-id="'+g.id+'"]');c.find("input").each(function(){jQuery(this).on("keyup",function(l){if(l.keyCode===9||l.keyCode===13){return}var k=jQuery(this).val();var m=jQuery(this);var a=new MyReg();a.setTestStr(k);if(k!==null&&!a.numeric()){m.addClass("is-invalid")}else{m.removeClass("is-invalid")}g.setMeasurement(m.attr("id"),k);c.find("div#totalFeet").html("Total: "+g.getTotalFeetFence())})});d='<div class="col-lg-6 col-md-6 col-sm-12 col-xs-12" data-id="'+g.id+'"><fieldset><legend>Style '+g.id+'</legend><div class="row"><div class="col-lg-7 col-md-7 col-sm-7 col-xs-12"><label for="styleFence">Style</label><select id="styleFence" class="form-control"><option value="none">--Select--</option>';var i=j.MasterStyleList.getStyleArray();for(var f=0;f<i.length;f++){d+=' <option value="'+i[f].id+'">'+i[f].desc+"</option>"}d+='</select> </div> <div class="col-lg-offset-1 col-lg-4 col-md-offset-1 col-md-4 col-sm-offset-1 col-sm-4 col-xs-12"><label for="styleHeight">Height</label><select id="styleHeight" class="form-control"><option value="none">--Select--</option> </select> </div> </div> <div class="row"><div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 table-responsive"> <table class="table table-bordered table-sm"><thead><tr><th>Qty</th><th>Description</th><th>Unit Price</th><th>Amount</th></tr></thead><tbody><tr><td id="Style'+g.id+'TotalFeet">0</td><td>Ft Fence</td><td id="Style'+g.id+'PricePerFoot">0.00</td><td id="Style'+g.id+'PricePerFootAmount">0.00</td></tr><tr><td><select id="Style'+g.id+'Gate4Foot" class="form-control">';for(var f=0;f<11;f++){d+='<option value="'+f+'">'+f+"</option>"}d+='</select> </td><td>Gate 4 Foot Wide</td><td id="Style'+g.id+'Gate4FootPrice">0.00</td><td id="Style'+g.id+'Gate4FootAmount">0.00</td></tr><tr><td><select id="Style'+g.id+'Gate5Foot" class="form-control">';for(f=0;f<11;f++){d+='<option value="'+f+'">'+f+"</option>"}d+='</select> </td><td>Gate 5 Foot Wide</td><td id="Style'+g.id+'Gate5FootPrice">0.00</td><td id="Style'+g.id+'Gate5FootAmount">0.00</td></tr><tr><td><select id="Style'+g.id+'Gate8Foot" class="form-control">';for(f=0;f<11;f++){d+='<option value="'+f+'">'+f+"</option>"}d+='</select></td><td>Double Drive 8 Foot Wide</td><td id="Style'+g.id+'Gate8FootPrice">0.00</td><td id="Style'+g.id+'Gate8FootAmount">0.00</td></tr><tr><td><select id="Style'+g.id+'Gate10Foot" class="form-control">';for(f=0;f<11;f++){d+='<option value="'+f+'">'+f+"</option>"}d+='</select></td><td>Double Drive 10 Foot Wide</td><td id="Style'+g.id+'Gate10FootPrice">0.00</td><td id="Style'+g.id+'Gate10FootAmount">0.00</td></tr><tr><td><select id="Style'+g.id+'EndPosts" class="form-control">';for(f=0;f<11;f++){d+='<option value="'+f+'">'+f+"</option>"}d+='</select></td><td>End Posts</td><td id="Style'+g.id+'EndPostsPrice">0.00</td><td id="Style'+g.id+'EndPostsAmount">0.00</td></tr><tr><td><select id="Style'+g.id+'CornerPosts" class="form-control">';for(f=0;f<11;f++){d+='<option value="'+f+'">'+f+"</option>"}d+='</select></td><td>Corner Posts</td><td id="Style'+g.id+'CornerPostsPrice">0.00</td><td id="Style'+g.id+'CornerPostsAmount">0.00</td></tr><tr><td><select id="Style'+g.id+'GatePosts" class="form-control">';for(f=0;f<11;f++){d+='<option value="'+f+'">'+f+"</option>"}d+='</select></td><td>Gate Posts</td><td id="Style'+g.id+'GatePostsPrice">0.00</td><td id="Style'+g.id+'GatePostsAmount">0.00</td></tr><tr><td id="Style'+g.id+'PostTopsQty">0</td><td>Post Tops <select id="Style'+g.id+'PostTopsSelect" class="form-control">';for(f=0;f<j.postTops.length;f++){d+='<option value="'+j.postTops[f].id+'">'+j.postTops[f].description+"</option>"}d+='</select></td><td id="Style'+g.id+'PostTopsPrice">0.00</td><td id="Style'+g.id+'PostTopsAmount">0.00</td></tr><tr><td><input type="number" id="Style'+g.id+'TemporaryFence" pattern="\\d*" placeholder="Qty" class="form-control"></td><td>Temporary Fence</td><td id="Style'+g.id+'TemporaryFencePrice">0.00</td><td id="Style'+g.id+'TemporaryFenceAmount">0.00</td></tr><tr><td><input type="number" id="Style'+g.id+'RemovalOldFence" pattern="\\d*" placeholder="Qty" class="form-control"></td><td>Removal Old Fence</td><td id="Style'+g.id+'RemovalOldFencePrice">0.00</td><td id="Style'+g.id+'RemovalOldFenceAmount">0.00</td></tr><tr><td><select id="Style'+g.id+'Permit" class="form-control">';for(f=0;f<2;f++){d+='<option value="'+f+'">'+f+"</option>"}d+='</select></td><td>Permit</td><td id="Style'+g.id+'PermitPrice">0.00</td><td id="Style'+g.id+'PermitAmount">0.00</td></tr><tr><td><select id="Style'+g.id+'RemovableSection" class="form-control">';for(f=0;f<6;f++){d+='<option value="'+f+'">'+f+"</option>"}d+='</select></td><td>Removable Section</td><td id="Style'+g.id+'RemovableSectionPrice">0.00</td><td id="Style'+g.id+'RemovableSectionAmount">0.00</td></tr><tr><td><select id="Style'+g.id+'HaulAwayDirt" class="form-control">';for(f=0;f<6;f++){d+='<option value="'+f+'">'+f+"</option>"}d+='</select></td><td>Haul Away Dirt</td><td id="Style'+g.id+'HaulAwayDirtPrice">0.00</td><td id="Style'+g.id+'HaulAwayDirtAmount">0.00</td></tr><tr><td><select id="Style'+g.id+'UpgradedLatch" class="form-control">';for(f=0;f<6;f++){d+='<option value="'+f+'">'+f+"</option>"}d+='</select></td><td>Upgraded Latch</td><td id="Style'+g.id+'UpgradedLatchPrice">0.00</td><td id="Style'+g.id+'UpgradedLatchAmount">0.00</td></tr><tr><td><select id="Style'+g.id+'UpgradedHinge" class="form-control">';for(f=0;f<6;f++){d+='<option value="'+f+'">'+f+"</option>"}d+='</select></td><td>Upgraded Hinge</td><td id="Style'+g.id+'UpgradedHingePrice">0.00</td><td id="Style'+g.id+'UpgradedHingeAmount">0.00</td></tr><tr><td colspan="3" class="text-right">Subtotal</td><td id="Style'+g.id+'SubTotal">0.00</td> </tr></tbody></table> </div></div> </fieldset></div>';e.append(d);var h=e.find('[data-id="'+g.id+'"]');jQuery('[data-toggle="popover"]').popover();h.find("select#styleFence").on("change",function(){var p=jQuery(this).val();var k=h.find("select#styleHeight");if(p==="none"){k.html('<option value="none">--Select--</option>');return}var o=j.MasterStyleList.getStyleByID(p);g.setStyleOfFence(o.styleID,o.styleDescription,o.type,o.postSpacing);var n=o.getAllHeights();var m='<option value="none">--Select--</option>';for(var l=0;l<n.length;l++){m+='<option value="'+n[l].id+'">'+n[l].height+"</option>"}k.html(m);if(g.type==="wood"){g.updatePostTopsQty()}else{g.setPostTopsQty(0)}});h.find("select#styleHeight").on("change",function(){var l=jQuery(this).val();if(l==="none"){return}var a=h.find("select#styleFence").val();var k=j.MasterStyleList.getStyleByID(a);var m=k.getHeightByID(l);g.setHeight(m.heightID,m.height);g.setPricePerFoot(m.pricePerFoot)});g.el.style.totalFeet=h.find("table td#Style"+g.id+"TotalFeet");g.el.style.pricePerFoot=h.find("table td#Style"+g.id+"PricePerFoot");g.el.style.pricePerFootAmount=h.find("table td#Style"+g.id+"PricePerFootAmount");h.find("table select#Style"+g.id+"Gate4Foot").on("change",function(){var k=jQuery(this).val();var a=j.MasterStyleList.getGateByWidthHeight(g.id,"4",g.heightID);g.setGate4FootQty(k);g.setGate4FootPrice(a.price)});g.el.style.gate4FootPrice=h.find("table td#Style"+g.id+"Gate4FootPrice");g.el.style.gate4FootAmount=h.find("table td#Style"+g.id+"Gate4FootAmount");h.find("table select#Style"+g.id+"Gate5Foot").on("change",function(){var k=jQuery(this).val();var a=j.MasterStyleList.getGateByWidthHeight(g.id,"5",g.heightID);g.setGate5FootQty(k);g.setGate5FootPrice(a.price)});g.el.style.gate5FootPrice=h.find("table td#Style"+g.id+"Gate5FootPrice");g.el.style.gate5FootAmount=h.find("table td#Style"+g.id+"Gate5FootAmount");h.find("table select#Style"+g.id+"Gate8Foot").on("change",function(){var k=jQuery(this).val();var a=j.MasterStyleList.getGateByWidthHeight(g.id,"8",g.heightID);g.setGate8FootQty(k);g.setGate8FootPrice(a.price)});g.el.style.gate8FootPrice=h.find("table td#Style"+g.id+"Gate8FootPrice");g.el.style.gate8FootAmount=h.find("table td#Style"+g.id+"Gate8FootAmount");h.find("table select#Style"+g.id+"Gate10Foot").on("change",function(){var k=jQuery(this).val();var a=j.MasterStyleList.getGateByWidthHeight(g.id,"10",g.heightID);g.setGate10FootQty(k);g.setGate10FootPrice(a.price)});g.el.style.gate10FootPrice=h.find("table td#Style"+g.id+"Gate10FootPrice");g.el.style.gate10FootAmount=h.find("table td#Style"+g.id+"Gate10FootAmount");h.find("table select#Style"+g.id+"EndPosts").on("change",function(){var m=jQuery(this).val();g.setEndPostsQty(m);var l=new RegExp(/^End\s?Posts$/i);for(var k=0;k<j.miscPrices.length;k++){if(l.test(j.miscPrices[k].description)){g.setEndPostsPrice(j.miscPrices[k].price);return}}});g.el.style.endPostsPrice=h.find("table td#Style"+g.id+"EndPostsPrice");g.el.style.endPostsAmount=h.find("table td#Style"+g.id+"EndPostsAmount");h.find("table select#Style"+g.id+"CornerPosts").on("change",function(){var m=jQuery(this).val();g.setCornerPostsQty(m);var l=new RegExp(/^Corner\s?(Posts|Post)$/i);for(var k=0;k<j.miscPrices.length;k++){if(l.test(j.miscPrices[k].description)){g.setCornerPostsPrice(j.miscPrices[k].price);return}}});g.el.style.cornerPostsPrice=h.find("table td#Style"+g.id+"CornerPostsPrice");g.el.style.cornerPostsAmount=h.find("table td#Style"+g.id+"CornerPostsAmount");h.find("table select#Style"+g.id+"GatePosts").on("change",function(){var m=jQuery(this).val();g.setGatePostsQty(m);var l=new RegExp(/^Gate\s?(Posts|Post)$/i);for(var k=0;k<j.miscPrices.length;k++){if(l.test(j.miscPrices[k].description)){g.setGatePostsPrice(j.miscPrices[k].price);return}}});g.el.style.gatePostsPrice=h.find("table td#Style"+g.id+"GatePostsPrice");g.el.style.gatePostsAmount=h.find("table td#Style"+g.id+"GatePostsAmount");h.find("table select#Style"+g.id+"PostTopsSelect").on("change",function(){var l=jQuery(this).val();g.setPostTop(l);for(var k=0;k<j.postTops.length;k++){if(j.postTops[k].id===parseInt(l)){g.setPostTopsPrice(j.postTops[k].price);break}}});g.el.style.postTopsPrice=h.find("table td#Style"+g.id+"PostTopsPrice");g.el.style.postTopsAmount=h.find("table td#Style"+g.id+"PostTopsAmount");g.el.style.postTopsQty=h.find("table td#Style"+g.id+"PostTopsQty");h.find("table input#Style"+g.id+"TemporaryFence").on("keyup",function(o){var n=jQuery(this).val();if(o.keyCode===9||o.keyCode===13){return}var l=new MyReg(n);if(!l.numeric()){jQuery(this).addClass("is-invalid");g.setTemporaryFencePrice(0);return}else{jQuery(this).removeClass("is-invalid")}g.setTemporaryFenceQty(n);var m=new RegExp(/^Temporary\s?Fence$/i);for(var k=0;k<j.miscPrices.length;k++){if(m.test(j.miscPrices[k].description)){g.setTemporaryFencePrice(j.miscPrices[k].price);return}}});g.el.style.temporaryFencePrice=h.find("table td#Style"+g.id+"TemporaryFencePrice");g.el.style.temporaryFenceAmount=h.find("table td#Style"+g.id+"TemporaryFenceAmount");h.find("table input#Style"+g.id+"RemovalOldFence").on("keyup",function(o){var n=jQuery(this).val();if(o.keyCode===9||o.keyCode===13){return}var l=new MyReg(n);if(!l.numeric()){jQuery(this).addClass("is-invalid");g.setRemovalOldFencePrice(0);return}else{jQuery(this).removeClass("is-invalid")}g.setRemovalOldFenceQty(n);var m=new RegExp(/^Removal\s?Old\s?Fence$/i);for(var k=0;k<j.miscPrices.length;k++){if(m.test(j.miscPrices[k].description)){g.setRemovalOldFencePrice(j.miscPrices[k].price);return}}});g.el.style.removalOldFencePrice=h.find("table td#Style"+g.id+"RemovalOldFencePrice");g.el.style.removalOldFenceAmount=h.find("table td#Style"+g.id+"RemovalOldFenceAmount");h.find("table select#Style"+g.id+"Permit").on("change",function(){var m=jQuery(this).val();g.setPermitQty(m);var l=new RegExp(/^Permit$/i);for(var k=0;k<j.miscPrices.length;k++){if(l.test(j.miscPrices[k].description)){g.setPermitPrice(j.miscPrices[k].price);return}}});g.el.style.permitPrice=h.find("table td#Style"+g.id+"PermitPrice");g.el.style.permitAmount=h.find("table td#Style"+g.id+"PermitAmount");h.find("table select#Style"+g.id+"RemovableSection").on("change",function(){var m=jQuery(this).val();g.setRemovableSectionQty(m);var l=new RegExp(/^Removable\s?Section$/i);for(var k=0;k<j.miscPrices.length;k++){if(l.test(j.miscPrices[k].description)){g.setRemovableSectionPrice(j.miscPrices[k].price);return}}});g.el.style.removableSectionPrice=h.find("table td#Style"+g.id+"RemovableSectionPrice");g.el.style.removableSectionAmount=h.find("table td#Style"+g.id+"RemovableSectionAmount");h.find("table select#Style"+g.id+"HaulAwayDirt").on("change",function(){var m=jQuery(this).val();g.setHaulAwayDirtQty(m);var l=new RegExp(/^Haul\s?Away\s?Dirt$/i);for(var k=0;k<j.miscPrices.length;k++){if(l.test(j.miscPrices[k].description)){g.setHaulAwayDirtPrice(j.miscPrices[k].price);return}}});g.el.style.haulAwayDirtPrice=h.find("table td#Style"+g.id+"HaulAwayDirtPrice");g.el.style.haulAwayDirtAmount=h.find("table td#Style"+g.id+"HaulAwayDirtAmount");h.find("table select#Style"+g.id+"UpgradedLatch").on("change",function(){var m=jQuery(this).val();g.setUpgradedLatchQty(m);var l=new RegExp(/^Upgraded\s?Latch$/i);for(var k=0;k<j.miscPrices.length;k++){if(l.test(j.miscPrices[k].description)){g.setUpgradedLatchPrice(j.miscPrices[k].price);return}}});g.el.style.upgradedLatchPrice=h.find("table td#Style"+g.id+"UpgradedLatchPrice");g.el.style.upgradedLatchAmount=h.find("table td#Style"+g.id+"UpgradedLatchAmount");h.find("table select#Style"+g.id+"UpgradedHinge").on("change",function(){var m=jQuery(this).val();g.setUpgradedHingeQty(m);var l=new RegExp(/^Upgraded\s?Hinge$/i);for(var k=0;k<j.miscPrices.length;k++){if(l.test(j.miscPrices[k].description)){g.setUpgradedHingePrice(j.miscPrices[k].price);return}}});g.el.style.upgradedHingePrice=h.find("table td#Style"+g.id+"UpgradedHingePrice");g.el.style.upgradedHingeAmount=h.find("table td#Style"+g.id+"UpgradedHingeAmount");g.el.style.subtotal=h.find("table td#Style"+g.id+"SubTotal")},removeStyleMeasurement:function(b){var a=this},saveMeasurements:function(){var a=this;var c=a.Styles.getAllStyles();var d=true;var b=[];c.forEach(function(f){var e=f.getJsonArray();if(e.Measurements.FrontLeft===0&&e.Measurements.Left===0&&e.Measurements.Back===0&&e.Measurements.Right===0&&e.Measurements.FrontRight===0&&e.Measurements.Extra1===0&&e.Measurements.Extra2===0&&e.Measurements.Extra3===0){d=false}b.push(e)});if(!d){return false}jQuery.ajax({type:"POST",url:window.baseURL+"/router.php?task=projectJS.saveMeasurements",data:{styles:b,jobID:a.jobID},dataType:"json",cache:false,beforeSend:function(){},complete:function(){},success:function(g){console.log(g);if(g.error){console.log(g.error_msg);return}if(g.data&&g.data.length>0){for(var f=0;f<g.data.length;f++){var e=a.Styles.getStyle(g.data[f].id);e.setDatabaseID(g.data[f].databaseID)}}},error:function(f,e,g){console.log(f,e,g)}})},getCustomerList:function(b){if(!b){return false}var a=this;jQuery.ajax({type:"POST",url:window.baseURL+"/router.php?task=projectJS.getCustomerList",data:{name:b},dataType:"json",cache:false,beforeSend:function(){},complete:function(){},success:function(d){console.log("Return data",d);if(d.error){console.log(d.error_msg);return}var j=d.data;var c=jQuery("div#main-content div#customerNameAutoComplete");var f=jQuery("div#main-content input#customerName");var k=jQuery("div#main-content div#customerInfo");c.find("div").each(function(){var l=jQuery(this);l.unbind("click");l.remove()});var e;if(j&&j.length>0){for(var g=0;g<j.length;g++){var i=j[g];var h;if(i.Address&&i.City&&i.State&&i.Zip){h="<br/><small>"+i.Address+"<br/>"+i.City+" "+i.State+", "+i.Zip+"</small>"}else{h=""}e='<div id="customerID'+i.CustomerID+'"><strong>'+i.CustomerName+"</strong><br/><small>"+i.CustomerPhone+"</small>"+h+"</div>";c.append(e);c.find("div#customerID"+i.CustomerID).on("click",function(){a.fillCustomer(i.CustomerID,i.CustomerName,i.CustomerPhoneType+": "+i.CustomerPhone,i.CustomerEmail);if(i.Address&&i.City&&i.State&&i.Zip){a.fillAddress(i.AddressID,i.Address,i.City,i.State,i.Zip);a.hideAddress()}a.hideCustomer();a.saveCustomer()})}}c.append('<div id="addNewCustomer"><strong>Add New Customer</strong></div>');c.css({width:f.innerWidth()+"px"});c.show();c.find("div#addNewCustomer").on("click",function(){jQuery("div#main-content div#addCustomerModal").modal("show");f.val("")});jQuery("div#main-content").one("click",function(){c.hide()})},error:function(e,d,f){console.log(e,d,f)}})},fillCustomer:function(f,e,b,d){var c=this;d=(d.length>0)?d:"None";var a=jQuery("div#main-content div#customerInfo");c.Customer.setID(f);c.Customer.addEmail(d);a.find("span#selectedCustomerName").html(e);a.find("span#selectedCustomerPhone").html(b);a.find("span#selectedCustomerEmail").html(d)},hideCustomer:function(){var a=jQuery("div#main-content div#customerInfo");a.find("input#customerName").val("").parent().hide();a.find("span#selectedCustomerName").parent().removeClass("d-none");a.find("span#selectedCustomerPhone").parent().removeClass("d-none");a.find("span#selectedCustomerEmail").parent().removeClass("d-none")},showCustomer:function(){var a=jQuery("div#main-content div#customerInfo");a.find("input#customerName").val("").parent().show();a.find("span#selectedCustomerName").parent().addClass("d-none");a.find("span#selectedCustomerPhone").parent().addClass("d-none");a.find("span#selectedCustomerEmail").parent().addClass("d-none")},saveCustomer:function(){var c=this.Customer.getID();var a=this.Customer.getAddressID();var e=this.jobID;var d=this.Customer.getDateSold();var b=this;if(!c||!a||!d){return false}jQuery.ajax({type:"POST",url:window.baseURL+"/router.php?task=projectJS.saveCustomer",data:{customerID:c,addressID:a,jobID:e,dateSold:d},dataType:"json",cache:false,beforeSend:function(){},complete:function(){},success:function(f){console.log(f);if(f.error){console.log(f.error_msg);return}if(f.data.jobID){b.jobID=f.data.jobID;jQuery("div#main-content div#customerInfo input#jobNumber").val(b.jobID)}},error:function(g,f,h){console.log(g,f,h)}})},addCustomer:function(e,g,c,f){if(!e||!g||!c){return false}var b=new MyReg();if(!b.alpha(e)){return false}if(!b.alpha(g)){return false}if(!b.phone(c)){return false}if(f.length>0&&!b.email(f)){return false}var d=this;var a=jQuery("div#main-content div#customerInfo");jQuery.ajax({type:"POST",url:window.baseURL+"/router.php?task=projectJS.addCustomer",data:{customerName:e,phoneType:g,phone:c,email:f},dataType:"json",cache:false,beforeSend:function(){jQuery("div.overlay").fadeIn("fast")},complete:function(){jQuery("div.overlay").fadeOut("fast")},success:function(i){console.log(i);if(i.error){console.log(i.error_msg);return}var h=i.data;f=(f.length>0)?f:"None";d.Customer.setName(e);a.find("span#selectedCustomerName").html(e);d.Customer.setPhone(g,c);a.find("span#selectedCustomerPhone").html(g+": "+c);d.Customer.setID(h);a.find("span#selectedCustomerEmail").html(f);d.hideCustomer();jQuery("div#main-content div#addCustomerModal").modal("hide");d.saveCustomer()},error:function(i,h,j){console.log(i,h,j)}})},getAddressList:function(a){var b=this;if(!a){return false}jQuery.ajax({type:"POST",url:window.baseURL+"/router.php?task=projectJS.getAddressList",data:{address:a},dataType:"json",cache:false,beforeSend:function(){},complete:function(){},success:function(g){console.log("Return data",g);if(g.error){console.log(g.error_msg);return}var i=g.data;var h=jQuery("div#main-content div#customerAddressAutoComplete");var d=jQuery("div#main-content input#address");h.find("div").each(function(){var j=jQuery(this);j.unbind("click");j.remove()});var f;if(i&&i.length>0){for(var c=0;c<i.length;c++){var e=i[c];f='<div id="addressID'+e.AddressID+'"><strong>'+e.Address+"</strong><br/><small>"+e.City+", "+e.State+" "+e.Zip+"</small></div>";h.append(f);h.find("div#addressID"+e.AddressID).on("click",function(){b.fillAddress(e.AddressID,e.Address,e.City,e.State,e.Zip);b.hideAddress();b.saveCustomer()})}}h.append('<div id="addNewAddress"><strong>Add New Address</strong></div>');h.css({width:d.innerWidth()+"px"});h.show();h.find("div#addNewAddress").on("click",function(){jQuery("div#main-content div#addCustomerAddressModal").modal("show");d.val("")});jQuery("div#main-content").one("click",function(){h.hide()})},error:function(e,d,f){console.log(e,d,f)}})},fillAddress:function(b,c,g,f,e){var a=jQuery("div#main-content div#customerInfo");var d=this;d.Customer.setAddressID(b);a.find("span#selectedCustomerAddress").html(c);a.find("span#selectedCustomerCity").html(g);a.find("span#selectedCustomerTaxCity").html("");a.find("span#selectedCustomerState").html(f);a.find("span#selectedCustomerZip").html(e)},addAddress:function(b,f,e,d){var c=this;if(!b||!f||!e||!d){return false}var a=new MyReg();if(!a.address(b)){return false}else{if(!a.state(e)){return false}else{if(!a.alpha(f)){return false}else{if(!a.zip(d)){return false}else{if(!c.Customer.getID()){return false}}}}}var g=jQuery("div#main-content div#addCustomerAddressModal");jQuery.ajax({type:"POST",url:window.baseURL+"/router.php?task=projectJS.addAddress",data:{address:b,city:f,state:e,zip:d},dataType:"json",cache:false,beforeSend:function(){jQuery("div.overlay").fadeIn("fast")},complete:function(){jQuery("div.overlay").fadeOut("fast")},success:function(i){console.log(i);if(i.error){console.log(i.error_msg);return}var h=i.data;c.fillAddress(h,b,f,e,d);c.hideAddress();g.modal("hide");g.find("input").each(function(){jQuery(this).val("")});c.saveCustomer()},error:function(i,h,j){console.log(i,h,j)}})},hideAddress:function(){jQuery("div#main-content div#customerInfo input#address").val("").parent().hide();jQuery("div#main-content div#customerInfo span#selectedCustomerAddress").parent().removeClass("d-none");jQuery("div#main-content div#customerInfo span#selectedCustomerCity").parent().removeClass("d-none");jQuery("div#main-content div#customerInfo span#selectedCustomerTaxCity").parent().removeClass("d-none");jQuery("div#main-content div#customerInfo span#selectedCustomerState").parent().removeClass("d-none");jQuery("div#main-content div#customerInfo span#selectedCustomerZip").parent().removeClass("d-none")},showAddress:function(){jQuery("div#main-content div#customerInfo input#address").val("").parent().show();jQuery("div#main-content div#customerInfo span#selectedCustomerAddress").parent().addClass("d-none");jQuery("div#main-content div#customerInfo span#selectedCustomerCity").parent().addClass("d-none");jQuery("div#main-content div#customerInfo span#selectedCustomerTaxCity").parent().addClass("d-none");jQuery("div#main-content div#customerInfo span#selectedCustomerState").parent().addClass("d-none");jQuery("div#main-content div#customerInfo span#selectedCustomerZip").parent().addClass("d-none")},uploadPicture:function(c){var a=this;if(c.files&&!c.files[0]){return false}if(!this.jobID){c.value="";this.displayErrorMsg("Please select a Customer and Address to create a Job Number","info");return}var b=new FormData();b.append("file",c.files[0]);b.append("jobID",this.jobID);jQuery.ajax({type:"POST",url:window.baseURL+"/router.php?task=projectJS.uploadPicture",data:b,dataType:"json",cache:false,processData:false,contentType:false,beforeSend:function(){jQuery("div.overlay").fadeIn("fast")},complete:function(){jQuery("div.overlay").fadeOut("fast")},success:function(e){console.log(e);if(e.error){c.value="";console.log(e.error_msg);return}var f=e.data;var d=new FileReader();d.addEventListener("load",function(){a.createPhotoDiv(f,d.result,"Uploaded Photo")});d.readAsDataURL(c.files[0]);c.value=""},error:function(e,d,f){console.log(e,d,f)}})},createPhotoDiv:function(g,e,b){var a=this;var d=new Image();var f=jQuery("div#main-content div#pictures div#addedPictures");d.title=b;d.src=e;d.classList.add("img-fluid");var c='<div id="uploadImage'+g+'" class="col-lg-6 col-md-6 col-sm-6 col-xs-12"><span id="imgPlaceholder"></span><textarea class="form-control mt-1" id="uploadImage'+g+'Notes" placeholder="Type Notes about photo here."></textarea><button id="remove" data-id="'+g+'" class="btn btn-primary" type="button">Remove Image</button></div>';f.append(c);f.find("div#uploadImage"+g+" span#imgPlaceholder").html(d);f.find("textarea#uploadImage"+g+"Notes").on("blur",function(){var h=jQuery(this).val();a.saveImageNote(g,h)});f.find("button#remove").on("click",function(){var h=jQuery(this).attr("data-id");a.removeImage(h)})},saveImageNote:function(c,b){console.log("ID: "+c+" Text: "+b);if(!c){return false}var a=this;jQuery.ajax({type:"POST",url:window.baseURL+"/router.php?task=projectJS.savePictureNotes",data:{noteID:c,noteText:b},dataType:"json",cache:false,beforeSend:function(){},complete:function(){},success:function(d){console.log(d);if(d.error){a.displayErrorMsg("Could not save notes about photo. Please try editing again.","danger");return}console.log("Note saved")},error:function(e,d,f){console.log(e,d,f)}})},removeImage:function(c){if(!c){return false}var a=this;var b=jQuery("div#main-content div#pictures div#addedPictures div#uploadImage"+c);jQuery.ajax({type:"POST",url:window.baseURL+"/router.php?task=projectJS.removePicture",data:{noteID:c},dataType:"json",cache:false,beforeSend:function(){jQuery("div.overlay").fadeIn("fast")},complete:function(){jQuery("div.overlay").fadeOut("fast")},success:function(d){console.log(d);if(d.error){a.displayErrorMsg("I could not remove this image","danger");return}b.remove()},error:function(e,d,f){console.log(e,d,f)}})},showEmailModal:function(){if(!this.jobID){this.displayErrorMsg("Cannot send an email without creating a Quote","info");return}jQuery("div#main-content div#emailQuoteModal").modal("show")},emailQuoteListeners:function(){var a=this;var b=jQuery("div#main-content div#emailQuoteModal");b.find("input#emailAddress").on("focus",function(){jQuery(this).val("")});b.on("shown.bs.modal",function(){b.find("input#emailAddress").val(a.Customer.getEmail())});b.find("input#emailAddress").on("keyup",function(){var d=jQuery(this).val();var c=new MyReg();if(!c.email(d)){jQuery(this).addClass("is-invalid")}else{jQuery(this).removeClass("is-invalid")}});b.find("input#subject").on("keyup",function(){var c=jQuery(this).val();if(jQuery(this).val().length<5){jQuery(this).addClass("is-invalid")}else{jQuery(this).removeClass("is-invalid")}});b.find("textarea#message").on("keyup",function(){if(jQuery(this).val()<6){jQuery(this).addClass("is-invalid")}else{jQuery(this).removeClass("is-invalid")}});b.find("button#sendEmail").on("click",function(){a.sendQuote()})},sendQuote:function(){var b=this;var f=jQuery("div#main-content div#emailQuoteModal");var d=f.find("input#emailAddress");var c=f.find("input#subject");var e=f.find("textarea#message");var a=new MyReg();var g=true;if(!a.email(d.val())){d.addClass("is-invalid");g=false}else{d.removeClass("is-invalid")}if(c.val().length<6){c.addClass("is-invalid");g=false}else{c.removeClass("is-invalid")}if(e.val().length<6){e.addClass("is-invalid");g=false}else{e.removeClass("is-invalid")}if(!g){b.displayErrorMsg("Please correct the errors in red below","danger");return}jQuery.ajax({type:"POST",url:window.baseURL+"/router.php?task=projectJS.emailQuote",data:{jobID:b.jobID,emailAddress:d.val(),subject:c.val(),message:e.val()},dataType:"json",cache:false,beforeSend:function(){jQuery("div.overlay").fadeIn("fast")},complete:function(){jQuery("div.overlay").fadeOut("fast")},success:function(h){console.log(h);if(h.error){b.displayErrorMsg(h.error_msg,"danger");return}f.modal("hide");b.displayErrorMsg("E-mail has been sent.","success")},error:function(i,h,j){console.log(i,h,j)}})},generateQuote:function(){var b=this;if(!b.jobID){b.displayErrorMsg("You must generate a quote before displaying it.","info");return}b.saveCustomer();b.saveMeasurements();var a=window.baseURL+"/docs/GenerateQuote.php?view=browser&jobID="+b.jobID;window.open(a,"__blank")}};